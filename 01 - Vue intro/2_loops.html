<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue loops</title>
    <style>
        section {
            width: 500px;
            margin: 3rem auto;
        }

        @keyframes shine {
            0% {
                background-position: right;
            }
        }

        section {
            width: 500px;
            margin: 3rem auto;
        }

        article {
            margin-bottom: 3rem;
        }

        article.placeholder * {
            display: block;
            height: 1rem;
            opacity: .5;
            border-radius: 6px;

            background-image: linear-gradient(to right,
                    transparent 33%,
                    rgba(255, 255, 255, 0.3) 50%,
                    transparent 66%);
            background-size: 300% 100%;

            animation: shine 2s infinite;
        }

        article.placeholder small {
            width: 30px;
            background-color: #999;
        }

        article.placeholder h4 {
            width: 60%;
            background-color: black;
        }

        article.placeholder p {
            background-color: black;
        }
    </style>
</head>

<body>
    <div id="app">
        <ul>
            <li v-for="(hobby, idx) in hobbies">
                {{ idx + 1 }}: {{ hobby }}
            </li>
        </ul>

        <hr>

        <p v-for="value, key in user">
            <strong>{{ key }}:</strong> {{ value }}
        </p>

        <hr>

        <p v-for="x in 3">
            {{ x }}
        </p>

        <hr>

        <section>
            <div v-if="loading">
                <article v-for="x in 8" class="placeholder">
                    <small></small>
                    <h4></h4>
                    <p></p>
                    <p></p>
                    <p></p>
                </article>
            </div>
            <div v-else>
                <article v-for="(post, idx) in posts">
                    <small>{{ idx + 1 }} / {{ posts.length }}</small>
                    <h3>{{ post.title }}</h3>
                    <p>{{ post.body }}</p>
                </article>
            </div>
        </section>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp, ref, reactive, onMounted } = Vue

        const app = createApp({
            setup() {
                const hobbies = ref(['Gaming', 'Travel', 'Food'])

                const user = reactive({
                    firstName: 'John',
                    lastName: 'Doe',
                    age: 20,
                })

                setTimeout(() => {
                    hobbies.value.push('Coding')

                    user.firstName = 'Jane'
                    user.age = 21
                }, 2000)

                //
                const posts = ref([])
                const loading = ref(true)

                const loadPosts = async () => {
                    loading.value = true
                    try {
                        const response = await fetch('https://jsonplaceholder.typicode.com/posts')

                        posts.value = await response.json()
                    } catch (error) {
                        console.error('Error loading posts:', error)
                    } finally {
                        loading.value = false
                    }
                }

                onMounted(() => {
                    // simulating slow internet by adding 2 second delay so loading state is shown
                    setTimeout(() => {
                        loadPosts()
                    }, 2000)
                })

                return {
                    hobbies,
                    user,
                    //
                    posts,
                    loading,
                }
            }
        }).mount('#app')
    </script>
</body>

</html>
